(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{394:function(t,e,n){},395:function(t,e,n){},400:function(t,e){},401:function(t,e){},409:function(t,e){},418:function(t,e){},419:function(t,e){},420:function(t,e){},428:function(t,e){},737:function(t,e,n){"use strict";n.r(e);var r=n(26),c=n.n(r),a=n(201),s=n.n(a),i=(n(394),n(395),n(4)),o=n.n(i),u=n(66),p=n(11),l=n(5),f=n(366),b=n.n(f),d=n(85),j=n(126),h=n(388);function O(){var t=d.f();return t.add(d.c.dense({units:1024,inputShape:[1024]})),t.add(d.c.dense({units:4})),t.add(d.c.activation({activation:"softmax"})),t.compile({loss:d.d.softmaxCrossEntropy,optimizer:d.h.adam(1e-4),metrics:["accuracy"]}),t.summary(),t}function x(t,e){return m.apply(this,arguments)}function m(){return(m=Object(p.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.infer(e,!0);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(t){return g.apply(this,arguments)}function g(){return(g=Object(p.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.argMax(1).data();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function v(t,e,n){return w.apply(this,arguments)}function w(){return(w=Object(p.a)(o.a.mark((function t(e,n,r){var c,a,s,i,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=["up","down","left","right"],t.next=3,x(e,r);case 3:return a=t.sent,t.next=6,n.predict(a);case 6:return s=t.sent,t.next=9,y(s);case 9:return i=t.sent,u=c[i],t.abrupt("return",u);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(t,e){return S.apply(this,arguments)}function S(){return(S=Object(p.a)(o.a.mark((function t(e,n){var r,c,a,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.next=3,n.infer(e.up,!0);case 3:return c=t.sent,t.next=6,n.infer(e.down,!0);case 6:return a=t.sent,t.next=9,n.infer(e.left,!0);case 9:return s=t.sent,t.next=12,n.infer(e.right,!0);case 12:return i=t.sent,r.tensors=d.b([c,a,s,i]),r.tensors=r.tensors.reshape([4,1024]),r.targets=d.g([0,1,2,3],[4],"int32"),r.targets=d.e(r.targets,4),t.abrupt("return",r);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(t,e){return M.apply(this,arguments)}function M(){return(M=Object(p.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("training network"),t.next=3,e.fit(n.tensors,n.targets,{epochs:10});case 3:r=t.sent,console.log("history: ",r),console.log("finished training"),e.predict(n.tensors).print();case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function E(t,e){return P.apply(this,arguments)}function P(){return(P=Object(p.a)(o.a.mark((function t(e,n){var r,c,a,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n;case 2:return n=t.sent,r=O(),t.next=6,k(e,n);case 6:return c=t.sent,t.next=9,C(r,c);case 9:return t.t0=r,t.next=12,x(e.control,n);case 12:return t.t1=t.sent,(a=t.t0.predict.call(t.t0,t.t1)).print(),t.next=17,y(a);case 17:return s=t.sent,console.log(["up","down","left","right"][s]),t.abrupt("return",{mobilenet:n,model:r});case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(){return(R=Object(p.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var z=n(35);var A=Object(j.b)((function(t){return{state:t}}))((function(t){var e=Object(r.useRef)(null),n=Object(r.useRef)(t.id),c=Object(r.useState)(null),a=Object(l.a)(c,2),s=a[0],i=a[1],u=Object(r.useState)(!1),f=Object(l.a)(u,2),j=f[0],h=f[1],O=Object(r.useRef)("controller"===n.current),x=Object(r.useState)(!0),m=Object(l.a)(x,2),y=m[0],g=m[1];function v(t){return w.apply(this,arguments)}function w(){return(w=Object(p.a)(o.a.mark((function e(r){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=new Image).crossOrigin="anonymous",c.src=r,c.height=200,c.width=200,e.next=7,c;case 7:c=e.sent,a=d.a.fromPixels(c),t.dispatch({type:n.current,tensor:a});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(p.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.current.getScreenshot(),t.next=3,v(n);case 3:t.sent;case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(r.useEffect)((function(){O.current&&v(e.current.getScreenshot())}),[]),Object(r.useEffect)((function(){setTimeout((function(){var e;O.current&&(null===(e=t.state.models)||void 0===e?void 0:e.hasOwnProperty("model"))&&function(){k.apply(this,arguments)}(),g(!y)}),350)}),[y]);var S=Object(r.useCallback)((function(t){if(j)i(null),h(!1);else{var n=e.current.getScreenshot();v(n),i(n),h(!0)}}));return Object(z.jsxs)(z.Fragment,{children:[!j&&Object(z.jsx)(b.a,{id:n,ref:e,mirrored:!0,screenshotFormat:"image/jpeg",videoConstraints:{height:200,width:200}}),j&&Object(z.jsx)("img",{id:"img",src:s,alt:""}),!O.current&&Object(z.jsx)("button",{onClick:S,style:{height:"30px"},children:"Capture"})]})}));n(434);var F=Object(j.b)((function(t){return{state:t}}))((function(t){var e=Object(r.useRef)(!1),n=Object(r.useState)(!0),c=Object(l.a)(n,2),a=c[0],s=c[1],i=Object(r.useRef)({});function f(){return(f=Object(p.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t.state,i.current);case 2:n=e.sent,t.dispatch({type:"models",models:n}),t.dispatch({type:"play",action:!0});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)((function(){i.current=function(){return R.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){setTimeout((function(){s(!a)}),1e3)}),[a]),!!(t.state.hasOwnProperty("up")&&t.state.hasOwnProperty("down")&&t.state.hasOwnProperty("left")&&t.state.hasOwnProperty("right"))&&!e.current&&(e.current=!0,function(){f.apply(this,arguments)}());var b={display:"grid",position:"absolute"};return Object(z.jsxs)("div",{children:[Object(z.jsx)("h3",{children:"Controls"}),Object(z.jsx)("p",{style:{fontSize:"50%",textAlign:"left",maxWidth:"800px"},children:"Set each of the four controls to a different hand position, face expression etc. As long as they are different you should be able to use it as a controller. Once all of these are set the game will automatically begin. (To reset all the controls, refresh the page.)"}),Object(z.jsxs)("div",{style:{display:"grid",position:"relative",width:"600px",height:"463px"},children:[Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{top:"0",left:"33.5%"}),children:Object(z.jsx)(A,{id:"up"})}),Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"0",left:"0%"}),children:Object(z.jsx)(A,{id:"left"})}),Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"0",right:"0%"}),children:Object(z.jsx)(A,{id:"right"})}),Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"6.6%",left:"33.5%"}),children:Object(z.jsx)(A,{id:"controller"})}),Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"-50%",left:"33.5%"}),children:Object(z.jsx)(A,{id:"down"})}),Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{top:"-20%",left:"-10%"})})]})]})})),T=n(20);var N=Object(j.b)((function(t){return{state:t}}))((function(t){var e="1000px",n="1000px",c=Array.from(Array(parseInt(e)/20).keys()).map((function(t){return 20*t})),a=Object(r.useState)(0),s=Object(l.a)(a,2),i=s[0],f=s[1],b=Object(r.useState)(0),d=Object(l.a)(b,2),j=d[0],h=d[1],O=Object(r.useState)(0),x=Object(l.a)(O,2),m=x[0],y=x[1],g=Object(r.useState)(0),w=Object(l.a)(g,2),k=w[0],S=w[1],C=Object(r.useState)(0),M=Object(l.a)(C,2),E=M[0],P=M[1],R=Object(r.useRef)(0),A=Object(r.useRef)([]),F=Object(r.useState)("down"),N=Object(l.a)(F,2),I=N[0],B=N[1],G=Object(r.useState)(150),J=Object(l.a)(G,2),L=J[0],D=J[1],W=Object(r.useState)(!0),q=Object(l.a)(W,2),H=q[0],K=q[1];function Q(){var t=[c[Math.floor(Math.random()*c.length)],c[Math.floor(Math.random()*c.length)]],e=Object(l.a)(t,2),n=e[0],r=e[1];E=n,k=r,P((function(){return n})),S((function(){return r}))}function U(){0===Math.abs(E-j)&&0===Math.abs(k-m)&&(Q(),R.current=R.current+1,f((function(t){return t+1})))}function V(){return(V=Object(p.a)(o.a.mark((function e(){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.models,r=t.state.control,e.next=4,v(r,n.model,n.mobilenet);case 4:c=e.sent,B(c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){!function(){V.apply(this,arguments)}(),function(){var t=A.current;(t=t.slice(1,t.length)).forEach((function(t){0===Math.abs(t.top-j)&&0===Math.abs(t.left-m)&&alert("Snake is eating itself!!")}))}(),"down"===I?j+=20:"up"===I?j-=20:"left"===I?m-=20:"right"===I&&(m+=20),(j>980||j<0)&&(j=980-Math.min(Math.max(j,0),980)),(m>980||m<0)&&(m=980-Math.min(Math.max(m,0),980)),h((function(){return j})),y((function(){return m})),A.current=[{top:j,left:m}].concat(Object(T.a)(A.current)),A.current.length=R.current+1,U()}Object(r.useEffect)((function(){Q()}),[]),Object(r.useEffect)((function(){setTimeout((function(){t.state.play&&X(),K(!H)}),L)}),[H]);var Y={width:n,height:e,position:"relative",border:"1px solid brown",margin:"auto"},Z={width:"20px",height:"20px",backgroundColor:"red",backgroundSize:"20px 20px",position:"absolute"},$={width:"20px",height:"20px",backgroundColor:"green",backgroundSize:"20px 20px",position:"absolute",top:"".concat(j,"px"),left:"".concat(m,"px")},_={width:"20px",height:"20px",backgroundColor:"blue",backgroundSize:"20px 20px",position:"absolute",top:"".concat(E,"px"),left:"".concat(k,"px")};return Object(z.jsxs)("div",{children:[Object(z.jsxs)("h1",{id:"score",style:{display:"flex",justifyContent:"center"},children:["Score: ",i]}),Object(z.jsxs)("div",{style:{display:"flex"},children:[Object(z.jsx)("input",{type:"range",min:"10",max:"1000",value:L,style:{width:"400px"},class:"slider",id:"gameSpeedSlider",onChange:function(t){D(t.target.value)}}),Object(z.jsxs)("p",{style:{fontSize:"25px"},children:["Game Speed: ",L,"ms"]})]}),Object(z.jsxs)("div",{className:"grid",id:"grid",style:Y,children:[Object(z.jsx)("div",{className:"snake",id:"snake",style:$}),A.current.map((function(t){return Object(z.jsx)("div",{style:Object(u.a)(Object(u.a)({},Z),{},{top:"".concat(t.top,"px"),left:"".concat(t.left,"px")})},A.current.indexOf(t))})),Object(z.jsx)("div",{className:"dot",id:"dot",style:_})]})]})}));var I=function(){return Object(z.jsx)("div",{className:"App",children:Object(z.jsxs)("header",{className:"App-header",children:[Object(z.jsx)("div",{children:Object(z.jsx)("div",{children:Object(z.jsx)("h1",{children:"Snake Game!"})})}),Object(z.jsxs)("div",{class:"container",children:[Object(z.jsx)(N,{}),Object(z.jsx)(F,{})]})]})})},B=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,738)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),r(t),c(t),a(t),s(t)}))},G=n(247),J=Object(G.b)((function(t,e){switch(e.type){default:t.control=e.tensor;break;case"up":t.up=e.tensor;break;case"down":t.down=e.tensor;break;case"left":t.left=e.tensor;break;case"right":t.right=e.tensor;break;case"models":t.models=e.models;break;case"play":t.play=e.action}return t}),{});s.a.render(Object(z.jsx)(c.a.StrictMode,{children:Object(z.jsx)(j.a,{store:J,children:Object(z.jsx)(I,{})})}),document.getElementById("root")),B()}},[[737,1,2]]]);
//# sourceMappingURL=main.34445508.chunk.js.map