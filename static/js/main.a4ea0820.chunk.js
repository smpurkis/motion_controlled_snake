(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{394:function(t,e,n){},395:function(t,e,n){},400:function(t,e){},401:function(t,e){},409:function(t,e){},418:function(t,e){},419:function(t,e){},420:function(t,e){},428:function(t,e){},737:function(t,e,n){"use strict";n.r(e);var r=n(26),c=n.n(r),a=n(201),s=n.n(a),i=(n(394),n(395),n(4)),o=n.n(i),u=n(66),p=n(11),f=n(6),l=n(366),b=n.n(l),j=n(85),d=n(126),h=n(388);function O(){var t=j.f();return t.add(j.c.dense({units:1024,inputShape:[1024]})),t.add(j.c.dense({units:4})),t.add(j.c.activation({activation:"softmax"})),t.compile({loss:j.d.softmaxCrossEntropy,optimizer:j.h.adam(1e-4),metrics:["accuracy"]}),t.summary(),t}function x(t,e){return m.apply(this,arguments)}function m(){return(m=Object(p.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.infer(e,!0);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function v(t){return y.apply(this,arguments)}function y(){return(y=Object(p.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.argMax(1).data();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t,e,n){return w.apply(this,arguments)}function w(){return(w=Object(p.a)(o.a.mark((function t(e,n,r){var c,a,s,i,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=["up","down","left","right"],t.next=3,x(e,r);case 3:return a=t.sent,t.next=6,n.predict(a);case 6:return s=t.sent,t.next=9,v(s);case 9:return i=t.sent,u=c[i],t.abrupt("return",u);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(t,e){return S.apply(this,arguments)}function S(){return(S=Object(p.a)(o.a.mark((function t(e,n){var r,c,a,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.next=3,n.infer(e.up,!0);case 3:return c=t.sent,t.next=6,n.infer(e.down,!0);case 6:return a=t.sent,t.next=9,n.infer(e.left,!0);case 9:return s=t.sent,t.next=12,n.infer(e.right,!0);case 12:return i=t.sent,r.tensors=j.b([c,a,s,i]),r.tensors=r.tensors.reshape([4,1024]),r.targets=j.g([0,1,2,3],[4],"int32"),r.targets=j.e(r.targets,4),t.abrupt("return",r);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function M(t,e){return C.apply(this,arguments)}function C(){return(C=Object(p.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("training network"),t.next=3,e.fit(n.tensors,n.targets,{epochs:10});case 3:r=t.sent,console.log("history: ",r),console.log("finished training"),e.predict(n.tensors).print();case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function E(t,e){return P.apply(this,arguments)}function P(){return(P=Object(p.a)(o.a.mark((function t(e,n){var r,c,a,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n;case 2:return n=t.sent,r=O(),t.next=6,k(e,n);case 6:return c=t.sent,t.next=9,M(r,c);case 9:return t.t0=r,t.next=12,x(e.control,n);case 12:return t.t1=t.sent,(a=t.t0.predict.call(t.t0,t.t1)).print(),t.next=17,v(a);case 17:return s=t.sent,console.log(["up","down","left","right"][s]),t.abrupt("return",{mobilenet:n,model:r});case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(){return(R=Object(p.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var F=n(36);var I=Object(d.b)((function(t){return{state:t}}))((function(t){var e=Object(r.useRef)(null),n=Object(r.useRef)(t.id),c=Object(r.useState)(null),a=Object(f.a)(c,2),s=a[0],i=a[1],u=Object(r.useState)(!1),l=Object(f.a)(u,2),d=l[0],h=l[1],O=Object(r.useRef)("controller"===n.current),x=Object(r.useState)(!0),m=Object(f.a)(x,2),v=m[0],y=m[1];function g(t){return w.apply(this,arguments)}function w(){return(w=Object(p.a)(o.a.mark((function e(r){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=new Image).crossOrigin="anonymous",c.src=r,c.height=200,c.width=200,e.next=7,c;case 7:c=e.sent,a=j.a.fromPixels(c),t.dispatch({type:n.current,tensor:a});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(p.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.current.getScreenshot(),t.next=3,g(n);case 3:t.sent;case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(r.useEffect)((function(){O.current&&g(e.current.getScreenshot())}),[]),Object(r.useEffect)((function(){setTimeout((function(){var e;O.current&&(null===(e=t.state.models)||void 0===e?void 0:e.hasOwnProperty("model"))&&function(){k.apply(this,arguments)}(),y(!v)}),350)}),[v]);var S=Object(r.useCallback)((function(t){if(d)i(null),h(!1);else{var n=e.current.getScreenshot();g(n),i(n),h(!0)}}));return Object(F.jsxs)(F.Fragment,{children:[!d&&Object(F.jsx)(b.a,{id:n,ref:e,mirrored:!0,screenshotFormat:"image/jpeg",videoConstraints:{height:200,width:200}}),d&&Object(F.jsx)("img",{id:"img",src:s,alt:""}),!O.current&&Object(F.jsx)("button",{onClick:S,style:{height:"30px"},children:"Capture"})]})}));n(434);var N=Object(d.b)((function(t){return{state:t}}))((function(t){var e=Object(r.useRef)(!1),n=Object(r.useState)(!0),c=Object(f.a)(n,2),a=c[0],s=c[1],i=Object(r.useRef)({});function l(){return(l=Object(p.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t.state,i.current);case 2:n=e.sent,t.dispatch({type:"models",models:n}),t.dispatch({type:"play",action:!0});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)((function(){i.current=function(){return R.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){setTimeout((function(){s(!a)}),1e3)}),[a]),!!(t.state.hasOwnProperty("up")&&t.state.hasOwnProperty("down")&&t.state.hasOwnProperty("left")&&t.state.hasOwnProperty("right"))&&!e.current&&(e.current=!0,function(){l.apply(this,arguments)}());var b={display:"grid",position:"absolute"};return Object(F.jsxs)("div",{children:[Object(F.jsx)("h3",{children:"Controls"}),Object(F.jsxs)("div",{style:{display:"grid",position:"relative",width:"600px",height:"463px"},children:[Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{top:"0",left:"33.5%"}),children:Object(F.jsx)(I,{id:"up"})}),Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"0",left:"0%"}),children:Object(F.jsx)(I,{id:"left"})}),Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"0",right:"0%"}),children:Object(F.jsx)(I,{id:"right"})}),Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"6.6%",left:"33.5%"}),children:Object(F.jsx)(I,{id:"controller"})}),Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{bottom:"-50%",left:"33.5%"}),children:Object(F.jsx)(I,{id:"down"})}),Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},b),{},{top:"-20%",left:"-10%"})})]})]})})),T=n(20);var z=Object(d.b)((function(t){return{state:t}}))((function(t){var e="1000px",n="1000px",c=Array.from(Array(parseInt(e)/20).keys()).map((function(t){return 20*t})),a=Object(r.useState)(0),s=Object(f.a)(a,2),i=s[0],l=s[1],b=Object(r.useState)(0),j=Object(f.a)(b,2),d=j[0],h=j[1],O=Object(r.useState)(0),x=Object(f.a)(O,2),m=x[0],v=x[1],y=Object(r.useState)(0),w=Object(f.a)(y,2),k=w[0],S=w[1],M=Object(r.useState)(0),C=Object(f.a)(M,2),E=C[0],P=C[1],R=Object(r.useRef)(0),I=Object(r.useRef)([]),N=Object(r.useState)("down"),z=Object(f.a)(N,2),A=z[0],B=z[1],J=Object(r.useState)(!0),L=Object(f.a)(J,2),D=L[0],G=L[1];function q(){var t=[c[Math.floor(Math.random()*c.length)],c[Math.floor(Math.random()*c.length)]],e=Object(f.a)(t,2),n=e[0],r=e[1];E=n,k=r,P((function(){return n})),S((function(){return r}))}function H(){0===Math.abs(E-d)&&0===Math.abs(k-m)&&(q(),R.current=R.current+1,l((function(t){return t+1})))}function K(){return(K=Object(p.a)(o.a.mark((function e(){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.models,r=t.state.control,e.next=4,g(r,n.model,n.mobilenet);case 4:c=e.sent,B(c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){!function(){K.apply(this,arguments)}(),function(){var t=I.current;(t=t.slice(1,t.length)).forEach((function(t){0===Math.abs(t.top-d)&&0===Math.abs(t.left-m)&&alert("Snake is eating itself!!")}))}(),"down"===A?d+=20:"up"===A?d-=20:"left"===A?m-=20:"right"===A&&(m+=20),(d>980||d<0)&&(d=980-Math.min(Math.max(d,0),980)),(m>980||m<0)&&(m=980-Math.min(Math.max(m,0),980)),h((function(){return d})),v((function(){return m})),I.current=[{top:d,left:m}].concat(Object(T.a)(I.current)),I.current.length=R.current+1,H()}Object(r.useEffect)((function(){q(),setInterval((function(){}),70)}),[]),Object(r.useEffect)((function(){setTimeout((function(){t.state.play&&Q(),G(!D)}),150)}),[D]);var U={width:n,height:e,position:"relative",border:"1px solid brown",margin:"auto"},V={width:"20px",height:"20px",backgroundColor:"red",backgroundSize:"20px 20px",position:"absolute"},W={width:"20px",height:"20px",backgroundColor:"green",backgroundSize:"20px 20px",position:"absolute",top:"".concat(d,"px"),left:"".concat(m,"px")},X={width:"20px",height:"20px",backgroundColor:"blue",backgroundSize:"20px 20px",position:"absolute",top:"".concat(E,"px"),left:"".concat(k,"px")};return Object(F.jsxs)("div",{children:[Object(F.jsxs)("h1",{id:"score",style:{display:"flex",justifyContent:"center"},children:["Score: ",i]}),Object(F.jsxs)("div",{className:"grid",id:"grid",style:U,children:[Object(F.jsx)("div",{className:"snake",id:"snake",style:W}),I.current.map((function(t){return Object(F.jsx)("div",{style:Object(u.a)(Object(u.a)({},V),{},{top:"".concat(t.top,"px"),left:"".concat(t.left,"px")})},I.current.indexOf(t))})),Object(F.jsx)("div",{className:"dot",id:"dot",style:X})]})]})}));var A=function(){return Object(F.jsx)("div",{className:"App",children:Object(F.jsxs)("header",{className:"App-header",children:[Object(F.jsx)("div",{children:Object(F.jsx)("div",{children:Object(F.jsx)("h1",{children:"Snake Game!"})})}),Object(F.jsxs)("div",{class:"container",children:[Object(F.jsx)(z,{}),Object(F.jsx)(N,{})]})]})})},B=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,738)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),r(t),c(t),a(t),s(t)}))},J=n(247),L=Object(J.b)((function(t,e){switch(e.type){default:t.control=e.tensor;break;case"up":t.up=e.tensor;break;case"down":t.down=e.tensor;break;case"left":t.left=e.tensor;break;case"right":t.right=e.tensor;break;case"models":t.models=e.models;break;case"play":t.play=e.action}return t}),{});s.a.render(Object(F.jsx)(c.a.StrictMode,{children:Object(F.jsx)(d.a,{store:L,children:Object(F.jsx)(A,{})})}),document.getElementById("root")),B()}},[[737,1,2]]]);
//# sourceMappingURL=main.a4ea0820.chunk.js.map